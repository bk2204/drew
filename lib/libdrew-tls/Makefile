DREW_TLS_DIR			:= lib/libdrew-tls
DREW_TLS_SONAME			:= libdrew-tls.so.0
DREW_TLS_SYMLINK		:= $(basename $(DREW_TLS_SONAME))

DREW_TLS_OBJS			+= global.o
DREW_TLS_OBJS			+= session.o
DREW_TLS_OBJS			+= structures.o
DREW_TLS_OBJS			+= priority.o

DREW_TLS_DIROBJS		:= $(patsubst %,$(DREW_TLS_DIR)/%,$(DREW_TLS_OBJS))

OBJECTS					+= $(DREW_TLS_DIROBJS)

ifeq ($(CFG_THREAD_SAFE),y)
$(DREW_TLS_DIR)/$(DREW_TLS_SONAME): CPPFLAGS += -DDREW_TLS_THREAD_SAFE
endif

$(DREW_TLS_DIR)/$(DREW_TLS_SONAME): CPPFLAGS += -I$(DREW_TLS_DIR)/include
$(DREW_TLS_DIR)/$(DREW_TLS_SONAME): $(DREW_TLS_DIROBJS)
	$(CXX) $(CXXFLAGS) $(LIBCFLAGS) -o $(.TARGET) $(.ALLSRC) $(LIBS)

$(DREW_TLS_SONAME): $(DREW_TLS_DIR)/$(DREW_TLS_SONAME)
	ln -sf $(.ALLSRC) $(.TARGET)

$(DREW_TLS_SYMLINK): $(DREW_TLS_SONAME)
	ln -sf $(.ALLSRC) $(.TARGET)
